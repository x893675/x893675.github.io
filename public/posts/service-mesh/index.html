<!DOCTYPE html>
<html lang="zh-Hans">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>
service mesh 初探
</title>

    
  <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" />



  
  <meta name="author" content="hanamichi" />
  <meta name="description" content="service mesh 的概念理解
" />



<meta name="generator" content="Hugo 0.62.2" />

<link rel="canonical" href="https://hanamichi.wiki/posts/service-mesh/" />


<meta property="og:title" content="service mesh 初探" />
<meta property="og:description" content="service mesh 的概念理解" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://hanamichi.wiki/posts/service-mesh/" />
<meta property="article:published_time" content="2019-02-14T14:21:26+08:00" />
<meta property="article:modified_time" content="2019-02-14T14:21:26+08:00" />



<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="service mesh 初探"/>
<meta name="twitter:description" content="service mesh 的概念理解"/>


<link rel="stylesheet" href="/css/github-markdown.css" />
<link rel="stylesheet" href="/css/semantic.min.css" />
<link rel="stylesheet" href="/css/site.css" />


<style>
  a {
    color: seagreen !important;
  }
</style>



<style>
  .inverted a {
     color: darkseagreen !important;
  }
</style>


  </head>

  
  <body style="background: #84a4b0;">
  
    <div class="flip-container">
      <div class="flipper">
        <section class="front">
          
<nav class="ui secondary inverted menu dream-menu">

  <div class="item">
    <i class="large link bullseye icon dream-flip-toggle" title="翻转！"></i>
  </div>
  <div class="item">
    <i class="large link home icon" title="首页" onclick="window.location.href = 'https:\/\/hanamichi.wiki'"></i>
  </div>
  <div class="item">
    <i id="theme-switch" class="large link icon" onclick="themeSwitch()"></i>
  </div>
</nav>

          
<div class="ui centered relaxed grid dream-grid">
  <div class="sixteen wide mobile sixteen wide tablet twelve wide computer column markdown-body dream-single">

    <section class="ui top attached segment" id="dream-save-post-as-img">
      <header style="margin-top: 0 !important;">
        <h2 class="ui header">
          service mesh 初探
          <div class="sub header">@ hanamichi · Thursday, Feb 14, 2019 · 8 分钟阅读 · 更新于 Feb 14, 2019</div>
        </h2>
      </header>
      <article style="margin-top: 2rem;"><p>service mesh 的概念理解</p>
<ul>
<li><a href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86">前置知识</a>
<ul>
<li><a href="#%E9%87%8D%E8%A6%81%E8%A7%82%E7%82%B9">重要观点</a></li>
</ul>
</li>
<li><a href="#envoy">Envoy</a>
<ul>
<li><a href="#%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5">核心概念</a></li>
<li><a href="#%E4%B8%8E%E7%B1%BB%E4%BC%BC%E8%BD%AF%E4%BB%B6%E6%AF%94%E8%BE%83">与类似软件比较</a>
<ul>
<li><a href="#nginx">nginx</a></li>
<li><a href="#haproxy">haproxy</a></li>
</ul>
</li>
<li><a href="#%E7%AE%80%E5%8D%95%E7%A4%BA%E4%BE%8B">简单示例</a>
<ul>
<li><a href="#%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87">环境准备</a></li>
<li><a href="#%E5%89%8D%E7%AB%AF%E4%BB%A3%E7%90%86%E5%8A%9F%E8%83%BD">前端代理功能</a></li>
</ul>
</li>
<li><a href="#%E5%8A%A8%E6%80%81%E9%85%8D%E7%BD%AE">动态配置</a></li>
</ul>
</li>
</ul>
<h2 id="前置知识">前置知识</h2>
<h3 id="重要观点">重要观点</h3>
<ul>
<li>Kubernetes 的本质是应用的生命周期管理，具体说是部署和管理（扩缩容、自动恢复、发布）。</li>
<li>Kubernetes 为微服务提供了可扩展、高弹性的部署和管理平台。</li>
<li>Service Mesh 的基础是透明代理，通过 sidecar proxy 拦截到微服务间流量后再通过控制平面配置管理微服务的行为。</li>
<li>Service Mesh 将流量管理从 Kubernetes 中解耦，Service Mesh 内部的流量无需 <code>kube-proxy</code> 组件的支持，通过为更接近微服务应用层的抽象，管理服务间的流量、安全性和可观察性。</li>
<li>Envoy xDS 定义了 Service Mesh 配置的协议标准。</li>
<li>Service Mesh 是对 Kubernetes 中的 service 更上层的抽象，它的下一步是 serverless。</li>
</ul>
<p>Service mesh 有如下几个特点：</p>
<ul>
<li>应用程序间通讯的中间层</li>
<li>轻量级网络代理</li>
<li>应用程序无感知</li>
<li>解耦应用程序的重试/超时、监控、追踪和服务发现</li>
</ul>
<p>目前两款流行的 service mesh 开源软件 <a href="https://istio.io/">Istio</a> 和 <a href="https://linkerd.io/">Linkerd</a> 都可以直接在 kubernetes 中集成，其中 Linkerd 已经成为 CNCF 成员。</p>
<p>参考资料:</p>
<ul>
<li><a href="https://jimmysong.io/kubernetes-handbook/usecases/service-mesh-fundamental.html">service mesh架构</a></li>
</ul>
<h2 id="envoy">Envoy</h2>
<blockquote>
<p>ENVOY IS AN OPEN SOURCE EDGE AND SERVICE PROXY, DESIGNED FOR CLOUD-NATIVE APPLICATIONS</p>
<p>Envoy 是开源的边缘和服务代理，用于云原生应用</p>
</blockquote>
<p>Envoy 是专为大型现代 SOA（面向服务架构）架构设计的 L7 代理和通信总线。该项目源于以下理念：</p>
<blockquote>
<p><em>网络对应用程序来说应该是透明的。当网络和应用程序出现问题时，应该很容易确定问题的根源。</em></p>
</blockquote>
<p>Envoy 提供了以下高级功能：</p>
<ul>
<li>
<p>非侵入的架构：<code>Envoy</code> 是和应用服务并行运行的，透明地代理应用服务发出/接收的流量。应用服务只需要和 <code>Envoy</code> 通信，无需知道其他微服务应用在哪里。</p>
</li>
<li>
<p>基于 Modern C++11实现，性能优异。</p>
</li>
<li>
<p>L3/L4 过滤器架构：<code>Envoy</code> 的核心是一个 L3/L4 代理，然后通过插件式的过滤器(<code>network filters</code>)链条来执行 TCP/UDP 的相关任务，例如 TCP 转发，TLS 认证等工作。</p>
</li>
<li>
<p>HTTP L7 过滤器架构：HTTP在现代应用体系里是地位非常特殊的应用层协议，所以 <code>Envoy</code> 内置了一个非常核心的过滤器: <code>http_connection_manager</code>。<code>http_connection_manager</code> 本身是如此特殊和复杂，支持丰富的配置，以及本身也是过滤器架构，可以通过一系列 http 过滤器(<code>http filters</code>)来实现 http协议层面的任务，例如：http路由，重定向，CORS支持等等。</p>
</li>
<li>
<p>HTTP/2 作为第一公民：<code>Envoy</code> 支持 HTTP/1.1 和 HTTP/2，推荐使用 HTTP/2。</p>
</li>
<li>
<p>gRPC 支持：因为对 HTTP/2 的良好支持，<code>Envoy</code> 可以方便的支持 gRPC，特别是在负载和代理上。</p>
</li>
<li>
<p>服务发现： 支持包括 DNS, EDS 在内的多种服务发现方案。</p>
</li>
<li>
<p>健康检查：内置健康检查子系统。</p>
</li>
<li>
<p>高级的负载均衡方案：除了一般的负载均衡，Envoy 还支持基于 rate limit 服务的多种高级负载均衡方案，包括： automatic retries, circuit breaking, global rate limiting</p>
</li>
<li>
<p>Tracing：方便集成 Open Tracing 系统，追踪请求</p>
</li>
<li>
<p>统计与监控：内置 stats 模块，方便集成诸如 prometheus/statsd 等监控方案</p>
</li>
<li>
<p>动态配置：通过动态配置API实现配置的动态调整，而无需重启 <code>Envoy</code> 服务的。</p>
</li>
</ul>
<h3 id="核心概念">核心概念</h3>
<p><strong>Host</strong></p>
<p>这里的 Host，可以理解为由 IP, Port 唯一确定的服务实例</p>
<p><strong>Downstream</strong></p>
<p>发送请求给 Envoy 的 Host 是 Downstream(下游)，例如gRPC的 client</p>
<p><strong>Upstream</strong></p>
<p>接收 Enovy 发出的请求的 Host 是Upstream(上游)，例如 gRPC的 server</p>
<p><strong>Listener</strong></p>
<p>Envoy 监听的一个地址，envoy既然是proxy，专门做转发，就得监听一个端口，接入请求，然后才能够根据策略转发，这个监听的端口称为listener</p>
<p><strong>endpoint</strong></p>
<p>是目标的ip地址和端口，这个是proxy最终将请求转发到的地方。</p>
<p><strong>Cluster</strong></p>
<p>一组功能一致的上游 Host，称为一个cluster。类似 <code>k8s</code> 的 <code>Service</code>, <code>nginx</code> 的 <code>upstream</code>。一个cluster是具有完全相同行为的多个endpoint，也即如果有三个容器在运行，就会有三个IP和端口，但是部署的是完全相同的三个服务，他们组成一个Cluster，从cluster到endpoint的过程称为负载均衡，可以轮询等。</p>
<p><strong>Http Route Table</strong></p>
<p>HTTP 的路由规则，例如请求的域名，Path符合什么规则，转发给哪个 Cluster。</p>
<h3 id="与类似软件比较">与类似软件比较</h3>
<h4 id="nginxhttpsnginxorgen"><a href="https://nginx.org/en/">nginx</a></h4>
<p>nginx是一个经典的现代web服务器。 它支持静态内容展现， HTTP L7反向代理 负载均衡，HTTP/2，以及其他的许多特性。 作为一个边缘反向代理，nginx提供了远远多于 Envoy 的功能特性， 但我们认为大多数的现代面向服务的架构其实不需要用到那么多的特性。 而 Envoy 在下列边缘代理的特性做得比 nginx 更为出色:</p>
<ul>
<li>完备的HTTP/2 透明代理支持。 Envoy支持HTTP/2 包括上游连接以及下游连接在内的双向通信。 而 nginx 仅仅支持HTTP/2 下游连接。</li>
<li>免费的高级负载功能。 而在 nginx 的世界，只有付费的 nginx plus 服务器才能提供类同于 Envoy 的高级负载功能。</li>
<li>可以在每一个服务节点的边界运行同样一套软件来处理事务。 在许多架构体系中，需要使用 nginx 与 haproxy 的混合部署架构。 相比之下，一个独立的代理解决方案会更有利于后续的运维维护。</li>
</ul>
<h4 id="haproxyhttpwwwhaproxyorg"><a href="http://www.haproxy.org/">haproxy</a></h4>
<p>haproxy 是一个经典的现代软负载均衡服务器。它提供基本的 HTTP 反向代理功能。 而 Envoy 在下列负载均衡的特性做得比 haproxy 更为出色：</p>
<ul>
<li>HTTP/2 支持。</li>
<li>可插拔架构。</li>
<li>与远程服务发现服务的整合。</li>
<li>与远程全局限速服务的整合。</li>
<li>提供大量的更为细致的统计分析。</li>
</ul>
<h3 id="简单示例">简单示例</h3>
<h4 id="环境准备">环境准备</h4>
<ul>
<li>docker</li>
<li>docker-compose</li>
<li>git clone <a href="https://github.com/envoyproxy/envoy.git">https://github.com/envoyproxy/envoy.git</a></li>
</ul>
<h4 id="前端代理功能">前端代理功能</h4>
<p>使用envoy自带的简单例子来验证envoy的前端代理功能</p>
<ul>
<li><code>cd envoy/examples/front-proxy</code></li>
<li><code>docker-compose up --build -d</code></li>
</ul>
<p>服务的结构图如下:</p>
<p><img src="/img/in-post/k8s-istio/envoymesh.png" alt="envoy"></p>
<p>front-envoy容器监听本机80端口，根据请求的url分发到后端的service1和service2，service1和service2容器中除service自身进程外，也有一个envoy进程。</p>
<p>测试envoy的路由能力:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#f92672">[</span>root@localhost front-proxy<span style="color:#f92672">]</span><span style="color:#75715e"># curl -v 192.168.234.185:8000/service/1</span>
* About to connect<span style="color:#f92672">(</span><span style="color:#f92672">)</span> to 192.168.234.185 port <span style="color:#ae81ff">8000</span> <span style="color:#f92672">(</span><span style="color:#75715e">#0)</span>
*   Trying 192.168.234.185...
* Connected to 192.168.234.185 <span style="color:#f92672">(</span>192.168.234.185<span style="color:#f92672">)</span> port <span style="color:#ae81ff">8000</span> <span style="color:#f92672">(</span><span style="color:#75715e">#0)</span>
&gt; GET /service/1 HTTP/1.1
&gt; User-Agent: curl/7.29.0
&gt; Host: 192.168.234.185:8000
&gt; Accept: */*
&gt; 
&lt; HTTP/1.1 <span style="color:#ae81ff">200</span> OK
&lt; content-type: text/html; charset<span style="color:#f92672">=</span>utf-8
&lt; content-length: <span style="color:#ae81ff">89</span>
&lt; server: envoy
&lt; date: Fri, <span style="color:#ae81ff">01</span> Mar <span style="color:#ae81ff">2019</span> 02:57:47 GMT
&lt; x-envoy-upstream-service-time: <span style="color:#ae81ff">6</span>
&lt; 
Hello from behind Envoy <span style="color:#f92672">(</span>service 1<span style="color:#f92672">)</span>! hostname: b23dda0a4e84 resolvedhostname: 172.18.0.3
* Connection <span style="color:#75715e">#0 to host 192.168.234.185 left intact</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#f92672">[</span>root@localhost front-proxy<span style="color:#f92672">]</span><span style="color:#75715e"># curl -v 192.168.234.185:8000/service/2</span>
* About to connect<span style="color:#f92672">(</span><span style="color:#f92672">)</span> to 192.168.234.185 port <span style="color:#ae81ff">8000</span> <span style="color:#f92672">(</span><span style="color:#75715e">#0)</span>
*   Trying 192.168.234.185...
* Connected to 192.168.234.185 <span style="color:#f92672">(</span>192.168.234.185<span style="color:#f92672">)</span> port <span style="color:#ae81ff">8000</span> <span style="color:#f92672">(</span><span style="color:#75715e">#0)</span>
&gt; GET /service/2 HTTP/1.1
&gt; User-Agent: curl/7.29.0
&gt; Host: 192.168.234.185:8000
&gt; Accept: */*
&gt; 
&lt; HTTP/1.1 <span style="color:#ae81ff">200</span> OK
&lt; content-type: text/html; charset<span style="color:#f92672">=</span>utf-8
&lt; content-length: <span style="color:#ae81ff">89</span>
&lt; server: envoy
&lt; date: Fri, <span style="color:#ae81ff">01</span> Mar <span style="color:#ae81ff">2019</span> 02:58:27 GMT
&lt; x-envoy-upstream-service-time: <span style="color:#ae81ff">4</span>
&lt; 
Hello from behind Envoy <span style="color:#f92672">(</span>service 2<span style="color:#f92672">)</span>! hostname: 4c15ee182dcf resolvedhostname: 172.18.0.4
* Connection <span style="color:#75715e">#0 to host 192.168.234.185 left intact</span>
</code></pre></div><p>扩展服务1的个数为3，测试envoy的负载均衡功能:</p>
<p><code>docker-compose scale service1=3</code></p>
<p>多次向 service1 发送请求，前端 envoy 将通过循环轮询三台 service1 机器来负载均衡请求：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#f92672">[</span>root@localhost front-proxy<span style="color:#f92672">]</span><span style="color:#75715e"># curl -v 192.168.234.185:8000/service/1</span>
* About to connect<span style="color:#f92672">(</span><span style="color:#f92672">)</span> to 192.168.234.185 port <span style="color:#ae81ff">8000</span> <span style="color:#f92672">(</span><span style="color:#75715e">#0)</span>
*   Trying 192.168.234.185...
* Connected to 192.168.234.185 <span style="color:#f92672">(</span>192.168.234.185<span style="color:#f92672">)</span> port <span style="color:#ae81ff">8000</span> <span style="color:#f92672">(</span><span style="color:#75715e">#0)</span>
&gt; GET /service/1 HTTP/1.1
&gt; User-Agent: curl/7.29.0
&gt; Host: 192.168.234.185:8000
&gt; Accept: */*
&gt; 
&lt; HTTP/1.1 <span style="color:#ae81ff">200</span> OK
&lt; content-type: text/html; charset<span style="color:#f92672">=</span>utf-8
&lt; content-length: <span style="color:#ae81ff">89</span>
&lt; server: envoy
&lt; date: Fri, <span style="color:#ae81ff">01</span> Mar <span style="color:#ae81ff">2019</span> 03:00:58 GMT
&lt; x-envoy-upstream-service-time: <span style="color:#ae81ff">4</span>
&lt; 
Hello from behind Envoy <span style="color:#f92672">(</span>service 1<span style="color:#f92672">)</span>! hostname: c1cb6c31f7f4 resolvedhostname: 172.18.0.6
* Connection <span style="color:#75715e">#0 to host 192.168.234.185 left intact</span>
<span style="color:#f92672">[</span>root@localhost front-proxy<span style="color:#f92672">]</span><span style="color:#75715e"># curl -v 192.168.234.185:8000/service/1</span>
* About to connect<span style="color:#f92672">(</span><span style="color:#f92672">)</span> to 192.168.234.185 port <span style="color:#ae81ff">8000</span> <span style="color:#f92672">(</span><span style="color:#75715e">#0)</span>
*   Trying 192.168.234.185...
* Connected to 192.168.234.185 <span style="color:#f92672">(</span>192.168.234.185<span style="color:#f92672">)</span> port <span style="color:#ae81ff">8000</span> <span style="color:#f92672">(</span><span style="color:#75715e">#0)</span>
&gt; GET /service/1 HTTP/1.1
&gt; User-Agent: curl/7.29.0
&gt; Host: 192.168.234.185:8000
&gt; Accept: */*
&gt; 
&lt; HTTP/1.1 <span style="color:#ae81ff">200</span> OK
&lt; content-type: text/html; charset<span style="color:#f92672">=</span>utf-8
&lt; content-length: <span style="color:#ae81ff">89</span>
&lt; server: envoy
&lt; date: Fri, <span style="color:#ae81ff">01</span> Mar <span style="color:#ae81ff">2019</span> 03:01:00 GMT
&lt; x-envoy-upstream-service-time: <span style="color:#ae81ff">5</span>
&lt; 
Hello from behind Envoy <span style="color:#f92672">(</span>service 1<span style="color:#f92672">)</span>! hostname: aac59ca26f25 resolvedhostname: 172.18.0.5
* Connection <span style="color:#75715e">#0 to host 192.168.234.185 left intact</span>
<span style="color:#f92672">[</span>root@localhost front-proxy<span style="color:#f92672">]</span><span style="color:#75715e"># curl -v 192.168.234.185:8000/service/1</span>
* About to connect<span style="color:#f92672">(</span><span style="color:#f92672">)</span> to 192.168.234.185 port <span style="color:#ae81ff">8000</span> <span style="color:#f92672">(</span><span style="color:#75715e">#0)</span>
*   Trying 192.168.234.185...
* Connected to 192.168.234.185 <span style="color:#f92672">(</span>192.168.234.185<span style="color:#f92672">)</span> port <span style="color:#ae81ff">8000</span> <span style="color:#f92672">(</span><span style="color:#75715e">#0)</span>
&gt; GET /service/1 HTTP/1.1
&gt; User-Agent: curl/7.29.0
&gt; Host: 192.168.234.185:8000
&gt; Accept: */*
&gt; 
&lt; HTTP/1.1 <span style="color:#ae81ff">200</span> OK
&lt; content-type: text/html; charset<span style="color:#f92672">=</span>utf-8
&lt; content-length: <span style="color:#ae81ff">89</span>
&lt; server: envoy
&lt; date: Fri, <span style="color:#ae81ff">01</span> Mar <span style="color:#ae81ff">2019</span> 03:01:01 GMT
&lt; x-envoy-upstream-service-time: <span style="color:#ae81ff">2</span>
&lt; 
Hello from behind Envoy <span style="color:#f92672">(</span>service 1<span style="color:#f92672">)</span>! hostname: b23dda0a4e84 resolvedhostname: 172.18.0.3
* Connection <span style="color:#75715e">#0 to host 192.168.234.185 left intact</span>
<span style="color:#f92672">[</span>root@localhost front-proxy<span style="color:#f92672">]</span><span style="color:#75715e"># curl -v 192.168.234.185:8000/service/1</span>
* About to connect<span style="color:#f92672">(</span><span style="color:#f92672">)</span> to 192.168.234.185 port <span style="color:#ae81ff">8000</span> <span style="color:#f92672">(</span><span style="color:#75715e">#0)</span>
*   Trying 192.168.234.185...
* Connected to 192.168.234.185 <span style="color:#f92672">(</span>192.168.234.185<span style="color:#f92672">)</span> port <span style="color:#ae81ff">8000</span> <span style="color:#f92672">(</span><span style="color:#75715e">#0)</span>
&gt; GET /service/1 HTTP/1.1
&gt; User-Agent: curl/7.29.0
&gt; Host: 192.168.234.185:8000
&gt; Accept: */*
&gt; 
&lt; HTTP/1.1 <span style="color:#ae81ff">200</span> OK
&lt; content-type: text/html; charset<span style="color:#f92672">=</span>utf-8
&lt; content-length: <span style="color:#ae81ff">89</span>
&lt; server: envoy
&lt; date: Fri, <span style="color:#ae81ff">01</span> Mar <span style="color:#ae81ff">2019</span> 03:01:04 GMT
&lt; x-envoy-upstream-service-time: <span style="color:#ae81ff">1</span>
&lt; 
Hello from behind Envoy <span style="color:#f92672">(</span>service 1<span style="color:#f92672">)</span>! hostname: c1cb6c31f7f4 resolvedhostname: 172.18.0.6
* Connection <span style="color:#75715e">#0 to host 192.168.234.185 left intact</span>
</code></pre></div><p>获取监测信息和服务信息:</p>
<p><code>docker-compose exec front-envoy /bin/bash</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">root@c08407f9ebea:/# curl localhost:8001/server_info
<span style="color:#f92672">{</span>
 <span style="color:#e6db74">&#34;version&#34;</span>: <span style="color:#e6db74">&#34;9612555c2e8171901b0c04a51af0030b11178116/1.10.0-dev/Clean/RELEASE/BoringSSL&#34;</span>,
 <span style="color:#e6db74">&#34;state&#34;</span>: <span style="color:#e6db74">&#34;LIVE&#34;</span>,
 <span style="color:#e6db74">&#34;command_line_options&#34;</span>: <span style="color:#f92672">{</span>
  <span style="color:#e6db74">&#34;base_id&#34;</span>: <span style="color:#e6db74">&#34;0&#34;</span>,
  <span style="color:#e6db74">&#34;concurrency&#34;</span>: 4,
  <span style="color:#e6db74">&#34;config_path&#34;</span>: <span style="color:#e6db74">&#34;/etc/front-envoy.yaml&#34;</span>,
  <span style="color:#e6db74">&#34;config_yaml&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
  <span style="color:#e6db74">&#34;allow_unknown_fields&#34;</span>: false,
  <span style="color:#e6db74">&#34;admin_address_path&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
  <span style="color:#e6db74">&#34;local_address_ip_version&#34;</span>: <span style="color:#e6db74">&#34;v4&#34;</span>,
  <span style="color:#e6db74">&#34;log_level&#34;</span>: <span style="color:#e6db74">&#34;info&#34;</span>,
  <span style="color:#e6db74">&#34;component_log_level&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
  <span style="color:#e6db74">&#34;log_format&#34;</span>: <span style="color:#e6db74">&#34;[%Y-%m-%d %T.%e][%t][%l][%n] %v&#34;</span>,
  <span style="color:#e6db74">&#34;log_path&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
  <span style="color:#e6db74">&#34;hot_restart_version&#34;</span>: false,
  <span style="color:#e6db74">&#34;service_cluster&#34;</span>: <span style="color:#e6db74">&#34;front-proxy&#34;</span>,
  <span style="color:#e6db74">&#34;service_node&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
  <span style="color:#e6db74">&#34;service_zone&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
  <span style="color:#e6db74">&#34;mode&#34;</span>: <span style="color:#e6db74">&#34;Serve&#34;</span>,
  <span style="color:#e6db74">&#34;max_stats&#34;</span>: <span style="color:#e6db74">&#34;16384&#34;</span>,
  <span style="color:#e6db74">&#34;max_obj_name_len&#34;</span>: <span style="color:#e6db74">&#34;60&#34;</span>,
  <span style="color:#e6db74">&#34;disable_hot_restart&#34;</span>: false,
  <span style="color:#e6db74">&#34;enable_mutex_tracing&#34;</span>: false,
  <span style="color:#e6db74">&#34;restart_epoch&#34;</span>: 0,
  <span style="color:#e6db74">&#34;file_flush_interval&#34;</span>: <span style="color:#e6db74">&#34;10s&#34;</span>,
  <span style="color:#e6db74">&#34;drain_time&#34;</span>: <span style="color:#e6db74">&#34;600s&#34;</span>,
  <span style="color:#e6db74">&#34;parent_shutdown_time&#34;</span>: <span style="color:#e6db74">&#34;900s&#34;</span>
 <span style="color:#f92672">}</span>,
 <span style="color:#e6db74">&#34;uptime_current_epoch&#34;</span>: <span style="color:#e6db74">&#34;3870s&#34;</span>,
 <span style="color:#e6db74">&#34;uptime_all_epochs&#34;</span>: <span style="color:#e6db74">&#34;3870s&#34;</span>
<span style="color:#f92672">}</span>

root@c08407f9ebea:/# curl localhost:8001/stats
access_log_file.flushed_by_timer: <span style="color:#ae81ff">274</span>
access_log_file.reopen_failed: <span style="color:#ae81ff">0</span>
access_log_file.write_buffered: <span style="color:#ae81ff">4</span>
access_log_file.write_completed: <span style="color:#ae81ff">4</span>
access_log_file.write_total_buffered: <span style="color:#ae81ff">0</span>
cluster.service1.bind_errors: <span style="color:#ae81ff">0</span>
cluster.service1.circuit_breakers.default.cx_open: <span style="color:#ae81ff">0</span>
cluster.service1.circuit_breakers.default.rq_open: <span style="color:#ae81ff">0</span>
cluster.service1.circuit_breakers.default.rq_pending_open: <span style="color:#ae81ff">0</span>
cluster.service1.circuit_breakers.default.rq_retry_open: <span style="color:#ae81ff">0</span>
cluster.service1.circuit_breakers.high.cx_open: <span style="color:#ae81ff">0</span>
cluster.service1.circuit_breakers.high.rq_open: <span style="color:#ae81ff">0</span>
cluster.service1.circuit_breakers.high.rq_pending_open: <span style="color:#ae81ff">0</span>
cluster.service1.circuit_breakers.high.rq_retry_open: <span style="color:#ae81ff">0</span>
cluster.service1.external.upstream_rq_200: <span style="color:#ae81ff">15</span>
cluster.service1.external.upstream_rq_2xx: <span style="color:#ae81ff">15</span>
cluster.service1.external.upstream_rq_completed: <span style="color:#ae81ff">15</span>
cluster.service1.http2.header_overflow: <span style="color:#ae81ff">0</span>
cluster.service1.http2.headers_cb_no_stream: <span style="color:#ae81ff">0</span>
cluster.service1.http2.rx_messaging_error: <span style="color:#ae81ff">0</span>
cluster.service1.http2.rx_reset: <span style="color:#ae81ff">0</span>
cluster.service1.http2.too_many_header_frames: <span style="color:#ae81ff">0</span>
cluster.service1.http2.trailers: <span style="color:#ae81ff">0</span>
cluster.service1.http2.tx_reset: <span style="color:#ae81ff">0</span>
cluster.service1.lb_healthy_panic: <span style="color:#ae81ff">0</span>
cluster.service1.lb_local_cluster_not_ok: <span style="color:#ae81ff">0</span>
cluster.service1.lb_recalculate_zone_structures: <span style="color:#ae81ff">0</span>
cluster.service1.lb_subsets_active: <span style="color:#ae81ff">0</span>
cluster.service1.lb_subsets_created: <span style="color:#ae81ff">0</span>
cluster.service1.lb_subsets_fallback: <span style="color:#ae81ff">0</span>
cluster.service1.lb_subsets_removed: <span style="color:#ae81ff">0</span>
cluster.service1.lb_subsets_selected: <span style="color:#ae81ff">0</span>
cluster.service1.lb_zone_cluster_too_small: <span style="color:#ae81ff">0</span>
cluster.service1.lb_zone_no_capacity_left: <span style="color:#ae81ff">0</span>
cluster.service1.lb_zone_number_differs: <span style="color:#ae81ff">0</span>
cluster.service1.lb_zone_routing_all_directly: <span style="color:#ae81ff">0</span>
cluster.service1.lb_zone_routing_cross_zone: <span style="color:#ae81ff">0</span>
cluster.service1.lb_zone_routing_sampled: <span style="color:#ae81ff">0</span>
cluster.service1.max_host_weight: <span style="color:#ae81ff">1</span>
cluster.service1.membership_change: <span style="color:#ae81ff">2</span>
cluster.service1.membership_degraded: <span style="color:#ae81ff">0</span>
cluster.service1.membership_healthy: <span style="color:#ae81ff">3</span>
cluster.service1.membership_total: <span style="color:#ae81ff">3</span>
cluster.service1.original_dst_host_invalid: <span style="color:#ae81ff">0</span>
cluster.service1.retry_or_shadow_abandoned: <span style="color:#ae81ff">0</span>
cluster.service1.update_attempt: <span style="color:#ae81ff">783</span>
cluster.service1.update_empty: <span style="color:#ae81ff">0</span>
cluster.service1.update_failure: <span style="color:#ae81ff">0</span>
cluster.service1.update_no_rebuild: <span style="color:#ae81ff">781</span>
cluster.service1.update_success: <span style="color:#ae81ff">783</span>
cluster.service1.upstream_cx_active: <span style="color:#ae81ff">8</span>
cluster.service1.upstream_cx_close_notify: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_cx_connect_attempts_exceeded: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_cx_connect_fail: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_cx_connect_timeout: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_cx_destroy: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_cx_destroy_local: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_cx_destroy_local_with_active_rq: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_cx_destroy_remote: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_cx_destroy_remote_with_active_rq: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_cx_destroy_with_active_rq: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_cx_http1_total: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_cx_http2_total: <span style="color:#ae81ff">8</span>
cluster.service1.upstream_cx_idle_timeout: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_cx_max_requests: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_cx_none_healthy: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_cx_overflow: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_cx_protocol_error: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_cx_rx_bytes_buffered: <span style="color:#ae81ff">1396</span>
cluster.service1.upstream_cx_rx_bytes_total: <span style="color:#ae81ff">2936</span>
cluster.service1.upstream_cx_total: <span style="color:#ae81ff">8</span>
cluster.service1.upstream_cx_tx_bytes_buffered: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_cx_tx_bytes_total: <span style="color:#ae81ff">2044</span>
cluster.service1.upstream_flow_control_backed_up_total: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_flow_control_drained_total: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_flow_control_paused_reading_total: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_flow_control_resumed_reading_total: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_internal_redirect_failed_total: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_internal_redirect_succeeded_total: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_rq_200: <span style="color:#ae81ff">15</span>
cluster.service1.upstream_rq_2xx: <span style="color:#ae81ff">15</span>
cluster.service1.upstream_rq_active: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_rq_cancelled: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_rq_completed: <span style="color:#ae81ff">15</span>
cluster.service1.upstream_rq_maintenance_mode: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_rq_pending_active: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_rq_pending_failure_eject: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_rq_pending_overflow: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_rq_pending_total: <span style="color:#ae81ff">8</span>
cluster.service1.upstream_rq_per_try_timeout: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_rq_retry: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_rq_retry_overflow: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_rq_retry_success: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_rq_rx_reset: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_rq_timeout: <span style="color:#ae81ff">0</span>
cluster.service1.upstream_rq_total: <span style="color:#ae81ff">15</span>
cluster.service1.upstream_rq_tx_reset: <span style="color:#ae81ff">0</span>
cluster.service1.version: <span style="color:#ae81ff">0</span>
cluster.service2.bind_errors: <span style="color:#ae81ff">0</span>
.....
.....
</code></pre></div><p>以下是envoy-front服务的envoy配置和service1的服务配置:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">static_resources:
  listeners:
  - address:
      socket_address:
        address: <span style="color:#ae81ff">0.0</span><span style="color:#ae81ff">.0</span><span style="color:#ae81ff">.0</span>
        port_value: <span style="color:#ae81ff">80</span>
    filter_chains:
    - filters:
      - name: envoy.http_connection_manager
        typed_config:
          <span style="color:#e6db74">&#34;@type&#34;</span>: type.googleapis.com/envoy.config.filter.network.http_connection_manager.v2.HttpConnectionManager
          codec_type: auto
          stat_prefix: ingress_http
          route_config:
            name: local_route
            virtual_hosts:
            - name: backend
              domains:
              - <span style="color:#e6db74">&#34;*&#34;</span>
              routes:
              - match:
                  prefix: <span style="color:#e6db74">&#34;/service/1&#34;</span>
                route:
                  cluster: service1
              - match:
                  prefix: <span style="color:#e6db74">&#34;/service/2&#34;</span>
                route:
                  cluster: service2
          http_filters:
          - name: envoy.router
            typed_config: {}
  clusters:
  - name: service1
    connect_timeout: <span style="color:#ae81ff">0.</span>25s
    type: strict_dns
    lb_policy: round_robin
    http2_protocol_options: {}
    load_assignment:
      cluster_name: service1
      endpoints:
      - lb_endpoints:
        - endpoint:
            address:
              socket_address:
                address: service1
                port_value: <span style="color:#ae81ff">80</span>
  - name: service2
    connect_timeout: <span style="color:#ae81ff">0.</span>25s
    type: strict_dns
    lb_policy: round_robin
    http2_protocol_options: {}
    load_assignment:
      cluster_name: service2
      endpoints:
      - lb_endpoints:
        - endpoint:
            address:
              socket_address:
                address: service2
                port_value: <span style="color:#ae81ff">80</span>
admin:
  access_log_path: <span style="color:#e6db74">&#34;/dev/null&#34;</span>
  address:
    socket_address:
      address: <span style="color:#ae81ff">0.0</span><span style="color:#ae81ff">.0</span><span style="color:#ae81ff">.0</span>
      port_value: <span style="color:#ae81ff">8001</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">static_resources:
  listeners:
  - address:
      socket_address:
        address: <span style="color:#ae81ff">0.0</span><span style="color:#ae81ff">.0</span><span style="color:#ae81ff">.0</span>
        port_value: <span style="color:#ae81ff">80</span>
    filter_chains:
    - filters:
      - name: envoy.http_connection_manager
        typed_config:
          <span style="color:#e6db74">&#34;@type&#34;</span>: type.googleapis.com/envoy.config.filter.network.http_connection_manager.v2.HttpConnectionManager
          codec_type: auto
          stat_prefix: ingress_http
          route_config:
            name: local_route
            virtual_hosts:
            - name: service
              domains:
              - <span style="color:#e6db74">&#34;*&#34;</span>
              routes:
              - match:
                  prefix: <span style="color:#e6db74">&#34;/service&#34;</span>
                route:
                  cluster: local_service
          http_filters:
          - name: envoy.router
            typed_config: {}
  clusters:
  - name: local_service
    connect_timeout: <span style="color:#ae81ff">0.</span>25s
    type: strict_dns
    lb_policy: round_robin
    load_assignment:
      cluster_name: local_service
      endpoints:
      - lb_endpoints:
        - endpoint:
            address:
              socket_address:
                address: <span style="color:#ae81ff">127.0</span><span style="color:#ae81ff">.0</span><span style="color:#ae81ff">.1</span>
                port_value: <span style="color:#ae81ff">8080</span>
admin:
  access_log_path: <span style="color:#e6db74">&#34;/dev/null&#34;</span>
  address:
    socket_address:
      address: <span style="color:#ae81ff">0.0</span><span style="color:#ae81ff">.0</span><span style="color:#ae81ff">.0</span>
      port_value: <span style="color:#ae81ff">8081</span>
</code></pre></div><h3 id="动态配置">动态配置</h3>
<p>以上的简单例子是envoy的静态配置，而envoy更强大的是使用xDS协议进行动态配置</p>
<p>Envoy 提供了如下的 API：</p>
<ul>
<li>CDS（Cluster Discovery Service）：集群发现服务</li>
<li>EDS（Endpoint Discovery Service）：端点发现服务</li>
<li>HDS（Health Discovery Service）：健康发现服务</li>
<li>LDS（Listener Discovery Service）：监听器发现服务</li>
<li>MS（Metric Service）：将 metric 推送到远端服务器</li>
<li>RLS（Rate Limit Service）：速率限制服务</li>
<li>RDS（Route Discovery Service）：路由发现服务</li>
<li>SDS（Secret Discovery Service）：秘钥发现服务</li>
</ul>
<p>所有名称以 DS 结尾的服务统称为 xDS。</p>
<p>envoy是为云原生应用设计的代理，可以很好的继承在k8s与service mesh中。现在<strong>Istio</strong>的默认sidecar容器就是envoy。</p>
<p>通过istio的<a href="https://istio.io/zh/docs/examples/bookinfo/">bookinfo示例</a>例子可以很好的体会envoy的动态配置功能</p>
<p>参考资料:</p>
<ul>
<li>
<p><a href="https://jimmysong.io/istio-handbook/data-plane/envoy-xds-protocol.html">xDS协议解析</a></p>
</li>
<li>
<p><a href="https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/arch_overview">envoy官方文档</a></p>
</li>
<li>
<p><a href="https://istio.io/zh/docs/concepts/what-is-istio/">istio文档</a></p>
</li>
<li>
<p><a href="https://www.cnblogs.com/163yun/p/8962278.html">深入service mesh背后的细节</a></p>
</li>
</ul></article>
    </section>

    <footer class="ui attached segment dream-tags">
      
        
          <a class="ui label" href="/tags/service-mesh" title="service mesh">service mesh</a>
        
          <a class="ui label" href="/tags/kubernetes" title="kubernetes">kubernetes</a>
        
      
      <div
        class="ui label"
        style="float: right; background: #1b1c1d !important; cursor: pointer;"
        onclick="savePostAsImg()">
        <i class="save icon"></i> Save as image
      </div>
    </footer>

    
      <footer class="ui attached segment">
        <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><br />本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。
      </footer>
    

    

  </div>
  <div class="sixteen wide mobile sixteen wide tablet four wide computer column">
    <article class="dream-header">
  <section class="ui top attached center aligned segment">
    <div class="ui small circular image">
      
        <img src="/me/hanamichi.jpg">
      
    </div>

    <h3 class="ui header">Hanamichi的博客<div class="sub header" style="margin-top: 0.5rem;">勤练带来力量！</div>
    </h3>

    <div class="ui horizontal list">
      
      <a class="item" href="/posts">
        <i class="archive icon" title="归档"></i>
      </a>
      
      <a class="item" href="/tags">
        <i class="tags icon" title="所有标签"></i>
      </a>
      <a class="item" href="/categories">
        <i class="th list icon" title="所有分类"></i>
      </a>
    </div>
  </section>

  
  <section class="ui attached center aligned segment dream-tags">
    
      <a class="ui label" href="/tags/c&#43;&#43;" title="c&#43;&#43;">c&#43;&#43;</a>
    
      <a class="ui label" href="/tags/docker" title="docker">docker</a>
    
      <a class="ui label" href="/tags/golang" title="golang">golang</a>
    
      <a class="ui label" href="/tags/kubernetes" title="kubernetes">kubernetes</a>
    
      <a class="ui label" href="/tags/linux" title="linux">linux</a>
    
      <a class="ui label" href="/tags/python" title="python">python</a>
    
      <a class="ui label" href="/tags/qemu" title="qemu">qemu</a>
    
      <a class="ui label" href="/tags/reading" title="reading">reading</a>
    
      <a class="ui label" href="/tags/rust" title="rust">rust</a>
    
      <a class="ui label" href="/tags/serverless" title="serverless">serverless</a>
    
      <a class="ui label" href="/tags/service-mesh" title="service-mesh">service-mesh</a>
    
      <a class="ui label" href="/tags/spice" title="spice">spice</a>
    
      <a class="ui label" href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97" title="云计算">云计算</a>
    
      <a class="ui label" href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1" title="微服务">微服务</a>
    
      <a class="ui label" href="/tags/%E6%B8%B8%E6%88%8F%E4%BA%BA%E7%94%9F" title="游戏人生">游戏人生</a>
    
      <a class="ui label" href="/tags/%E7%94%9F%E6%B4%BB" title="生活">生活</a>
    
      <a class="ui label" href="/tags/%E7%BC%96%E7%A8%8B%E6%A6%82%E5%BF%B5" title="编程概念">编程概念</a>
    
      <a class="ui label" href="/tags/%E8%B5%9E%E8%B5%8F" title="赞赏">赞赏</a>
    
  </section>
  

  
  <section class="ui attached segment dream-categories">
    <div class="ui accordion">
      
        <div class="title">
          <i class="dropdown icon"></i>
          <a href="/categories/linux" class="item">linux</a>
        </div>
        <div class="content">
          <div class="ui list">
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/git/" class="item">git常用命令记录</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/linux-cmd/" class="item">linux常用命令记录</a>
              </div>
            </div>
          
          </div>
        </div>
      
        <div class="title">
          <i class="dropdown icon"></i>
          <a href="/categories/%E4%BA%91%E5%8E%9F%E7%94%9F" class="item">云原生</a>
        </div>
        <div class="content">
          <div class="ui list">
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/client-go/" class="item">client-go详解</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/serverless/" class="item">serverless理解</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/soa-microservice/" class="item">SOA及微服务概念</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/go-micro-istio/" class="item">微服务使用istio分布式追踪</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/k8s-ciro/" class="item">k8s crio 测试环境搭建</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/service-mesh/" class="item">service mesh 初探</a>
              </div>
            </div>
          
          </div>
        </div>
      
        <div class="title">
          <i class="dropdown icon"></i>
          <a href="/categories/%E5%AE%B9%E5%99%A8" class="item">容器</a>
        </div>
        <div class="content">
          <div class="ui list">
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/k8s-ciro/" class="item">k8s crio 测试环境搭建</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/docker/" class="item">常用容器服务构建</a>
              </div>
            </div>
          
          </div>
        </div>
      
        <div class="title">
          <i class="dropdown icon"></i>
          <a href="/categories/%E5%BA%95%E5%B1%82%E8%99%9A%E6%8B%9F%E5%8C%96%E6%8A%80%E6%9C%AF" class="item">底层虚拟化技术</a>
        </div>
        <div class="content">
          <div class="ui list">
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/qemu/" class="item">关于Qemu的记录</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/spice-h264/" class="item">spice图形显示优化</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/spice/" class="item">云桌面spice初探</a>
              </div>
            </div>
          
          </div>
        </div>
      
        <div class="title">
          <i class="dropdown icon"></i>
          <a href="/categories/%E7%94%9F%E6%B4%BB-%E9%9A%8F%E7%AC%94-%E6%80%BB%E7%BB%93" class="item">生活-随笔-总结</a>
        </div>
        <div class="content">
          <div class="ui list">
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/buy-me-a-coffee/" class="item">Buy Me A Coffee</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/20180601%E9%9A%8F%E7%AC%94/" class="item">随便扯扯淡-2018/06</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/20170321%E9%9A%8F%E7%AC%94/" class="item">随便扯扯淡-2017/03</a>
              </div>
            </div>
          
          </div>
        </div>
      
        <div class="title">
          <i class="dropdown icon"></i>
          <a href="/categories/%E7%9E%8E%E6%8A%98%E8%85%BE" class="item">瞎折腾</a>
        </div>
        <div class="content">
          <div class="ui list">
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/openwrt/" class="item">openwrt软路由搭建</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/game-bb/" class="item">血源诅咒记录</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/aliyun-k8s/" class="item">阿里云k8s环境搭建测试</a>
              </div>
            </div>
          
          </div>
        </div>
      
        <div class="title">
          <i class="dropdown icon"></i>
          <a href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0" class="item">编程语言学习</a>
        </div>
        <div class="content">
          <div class="ui list">
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/rust/" class="item">rust学习笔记</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/golang/" class="item">golang学习笔记</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/python/" class="item">python code gist</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/closure/" class="item">闭包的理解</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/c-plus-plus-gist/" class="item">C&#43;&#43;单例模式与线程类思考</a>
              </div>
            </div>
          
          </div>
        </div>
      
        <div class="title">
          <i class="dropdown icon"></i>
          <a href="/categories/%E9%98%85%E8%AF%BB" class="item">阅读</a>
        </div>
        <div class="content">
          <div class="ui list">
          
            <div class="item">
              <div class="content">
                <a href="https://hanamichi.wiki/posts/%E7%A8%8B%E5%BA%8F%E5%91%98%E4%BF%AE%E7%82%BC%E4%B9%8B%E9%81%93/" class="item">程序员修炼之道-阅读摘抄</a>
              </div>
            </div>
          
          </div>
        </div>
      
    </div>
  </section>
  

  <section class="ui bottom attached center aligned segment">
      
      <p>© 2017 - 2020 Hanamichi的博客</p>
      
      <p>Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a> with theme <a href="https://github.com/g1eny0ung/hugo-theme-dream" target="_blank">Dream</a>.</p>
  </section>
</article>

  </div>
</div>

        </section>
        <section class="back">
          
<nav class="ui secondary inverted menu dream-menu">

  <div class="item">
    <i class="large link bullseye icon dream-flip-toggle" title="翻转！"></i>
  </div>
  <div class="item">
    <i class="large link home icon" title="首页" onclick="window.location.href = 'https:\/\/hanamichi.wiki'"></i>
  </div>
  <div class="item">
    <i id="theme-switch" class="large link icon" onclick="themeSwitch()"></i>
  </div>
</nav>

          <div class="ui centered relaxed grid dream-grid dream-back">
  
    <section class="sixteen wide mobile eight wide tablet four wide computer column dream-column">
      <article>
        <div class="ui top attached segment">
          <h3 class="ui header">关于我</h3>
        </div>
        <div class="ui attached segment markdown-body">
          <p>关于我</p>
<p>Hanamichi 的❤博客</p>
<p>记录一些🌈生活上，技术上的事</p>
<p>全平台玩家(pc-steam, ps4, switch), 不碰手游不碰国内垃圾网游</p>
<p>职业是后端工程师</p>
<p>正在努力学习</p>
<p>对云原生微服务感兴趣</p>
<p>主要的技术栈是：</p>
<ul>
<li>golang</li>
<li>kubernetes</li>
<li>微服务架构</li>
</ul>
<p>略懂一二:</p>
<ul>
<li>python</li>
<li>C/C++</li>
</ul>
<p>学习中：</p>
<ul>
<li>Rust</li>
<li>JavaScript</li>
</ul>
<p>目前在 <a href="http://www.99cloud.net">99cloud</a> 工作</p>
<p>&ndash; 2019 年 12 月 31 日更新</p>
        </div>
      </article>
    </section>
  
    <section class="sixteen wide mobile eight wide tablet four wide computer column dream-column">
      <article>
        <div class="ui top attached segment">
          <h3 class="ui header">2020年的计划</h3>
        </div>
        <div class="ui attached segment markdown-body">
          <p>2020年的计划</p>
<ul>
<li>以<a href="https://github.com/x893675/note">github issue和wiki</a>记录平时的一些想法，坚持整理然后写入博客</li>
<li>加深golang微服务的理解, 写一个便于重复利用的微服务项目</li>
<li>等多关注云原声CNCF开源社区动态，争取做些贡献</li>
<li>完成两本书的阅读和笔记记录(程序员修炼之道，代码整洁之道)</li>
<li>日本旅游</li>
</ul>
        </div>
      </article>
    </section>
  
    <section class="sixteen wide mobile eight wide tablet four wide computer column dream-column">
      <article>
        <div class="ui top attached segment">
          <h3 class="ui header">其他</h3>
        </div>
        <div class="ui attached segment markdown-body">
          <p>其他</p>
<p>如果你喜欢我的文章 or 我的项目，或者它们可以给你带来帮助。</p>
<p>You can <a href="/posts/buy-me-a-coffee">buy me a coffee</a>. ~</p>
<p>我的<strong>微信赞赏码</strong>：</p>
<p><img class="ui image" src="/me/微信赞赏码.jpg" alt="wechat" /></p>
        </div>
      </article>
    </section>
  

  <section class="sixteen wide mobile eight wide tablet four wide computer column dream-column">
    <article>
      <div class="ui top attached segment">
        <h3 class="ui header">社交链接</h3>
      </div>
      <div class="ui attached segment">
        <nav class="ui secondary menu dream-menu">
          
            <div class="item">
              <a href="mailto:x893675@gmail.com">
                <i class="large mail icon" title="email"></i>
              </a>
            </div>
          

          
            <div class="item">
              <a href="https://github.com/x893675" target="_blank">
                <i class="large github icon" title="github"></i>
              </a>
            </div>
          

          

          

          
        </nav>
      </div>
    </article>
  </section>

  <section class="sixteen wide mobile eight wide tablet four wide computer column dream-column">
    
      <footer class="ui segment">
        <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><br />本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。
      </footer>
    
  </section>

  
  
</div>

        </section>
      </div>
    </div>

    <script src="/js/jquery.min.js"></script>
<script src="/js/semantic.min.js"></script>
<script src="/js/imagesloaded.pkgd.min.js"></script>
<script src="/js/masonry.pkgd.min.js"></script>
<script src="/js/nav.js"></script>
<script src="/js/header.js"></script>
<script src="/js/main.js"></script>
<script src="/js/theme.js"></script>
<script src="/js/html2canvas.min.js"></script>


  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-156166070-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



  </body>
</html>
